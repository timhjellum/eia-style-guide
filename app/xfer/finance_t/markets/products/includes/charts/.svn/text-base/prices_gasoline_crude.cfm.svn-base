<script type="text/javascript">
		var chart,
		opts_prices_gasoline_crude = {
			chart: {
				renderTo: 'price_gas',
				zoomType: 'x',
                margin: [75, 40, 85, 30]
			},
			credits: {
			  enabled: false
			},				
			title: {
				text: 'U.S. retail gasoline price, refiner acquisition cost of crude oil', //chart title 
				align: 'left',
				y: 15,
				style:  {
				  color: 'black',
				  fontWeight: 'bold',
				  fontSize: '16px',
				  fontFamily: 'Arial'
				}
			},
			xAxis: {
				type: 'datetime',
				tickInterval: 365*24 * 3600 * 1000,
				lineColor: '#000000',
				labels: {
				  y: 20,
				  style: {
					color: 'black',
					fontFamily: 'Arial'
				  }
				}					
			},
			labels: {
				items: [{
					html: 'dollars per gallon', // Y Axis label
					style:  {
						left:  '-15px',
						top:  '-25px',
						color: '#5d9732',
						fontFamily: 'Arial'						
					}
				},{
					html: 'dollars per barrel*', // Y Axis label
					style:  {
						left:  '555px',
						top:  '-25px',
						color: '#0096d7',
						fontFamily: 'Arial'				
					}
				},
				{
				  html: '*real 2009 dollars, monthly average',
				  style:  {
					left:  '-20px',
					top:  '288px',
					color: 'gray',
					fontSize: '10px',
					fontFamily: 'Arial'
				  }
				},				
				{
				  html: 'Source: <a href="http://www.eia.gov/">U.S. Energy Information Administration</a>, <a href="http://thomsonreuters.com/">Thomson Reuters</a>',
				  style:  {
					left:  '-20px',
					top:  '300px',
					color: 'gray',
					fontSize: '10px',
					fontFamily: 'Arial'
				  }
				},
				{
				  html: 'Updated: Monthly | Last Updated: April 14, 2011',
				  style:  {
					left:  '-20px',
					top:  '312px',
					color: 'gray',					
					fontSize: '10px',
					fontFamily: 'Arial'
				  }
				}					
				
				]
			}, 
		   legend: {
			  enabled: true,
			  layout: 'horizontal',
			  align: 'center',
			  verticalAlign: 'bottom',	  
			  x: 0,
			  y: -30,
			  borderWidth: 0,
			  symbolPadding: 5,					
			  itemStyle: {
				fontFamily: 'Arial',
				color: '#189bd7',
				textDecoration: 'none'
			  },
			  itemHoverStyle: {
				fontFamily: 'Arial',
				color: '#189bd7',
				textDecoration: 'underline'
			  }
			},				
    tooltip: {
      style: { 
        padding: 5,
        fontFamily: 'Arial'
      },
      formatter: function() {return '<b>' + this.series.name + '</b><br>' + Highcharts.dateFormat('%B %Y', this.x)
	         	 + '<br/>'  + '$' + Highcharts.numberFormat(this.y, 2) + (this.series.name == 'U.S. retail gasoline' ? ' per gallon' : ' per barrel');			
	  }
    },				  
			yAxis: [{ // Primary yAxis
                title: null,
				min: 1,
				max: 4.5,
				tickInterval: 0.5,				
				labels: {
					style:{ 
						color: '#5d9732',
						fontFamily: 'Arial'
					}
				}
      }, { // Secondary yAxis
        title: null,
        opposite: true,
		        min:0,
				max:150,
				tickInterval: 20,
				labels: {
					style:{ 
						color: '#0096d7',
						fontFamily: 'Arial'
					},
					formatter: function(){
						if( this.value  < 0 ) return '';
						else return this.value;
					}
				}
    	}],
			plotOptions: {
				series:{
					marker: {
						enabled: false
					}
				},
				line: {
					shadow:0,
					lineWidth: 2,
					marker: {
						enabled: false,
						states: {
							hover: {
								enabled: true,
								radius: 4
							}
						}
					},
					states: {
						hover: {
							lineWidth: 2,
							marker: {
								radius: 1
							}
						}
					}
				}
			},
			exporting: {
				buttons:{
					printButton: {
						enabled: false
					}
				}
			},
			navigation: {
				buttonOptions: {
					y: 0
				}
			},				
			colors:[
				'#5D9732',
				'#0096d7',
				'#003953',
				'#a33340',
				'#bd732a',
				'#103203',
				'#ffc702'
			],
			series: []
		},
		gasolineSeries= {
			data: [],
			type: 'line',
			name: 'U.S. retail gasoline'
		},
		racSeries= {
			data: [],
			type: 'line',
			name: 'refiner acquisition cost of crude oil',
			yAxis: 1,
			
		},
		breakLine = {
			data: [],
			type:'scatter',
			lineWidth: 1,
			color: '#7f7f7f',
			dashStyle: 'shortdash',  			
			shadow: 0,
			showInLegend: false,
			yAxis: 1
		};
			
	$(window).load(function() {
		$.get( 'data.cfm?chart=prices_gasoline_crude', function(data) {
			var vals = data.DATA,
					now = new Date(),
					tmp;
					
			$.each(vals, function(lineNo, items) {
					var date = Date.parse(items[1]+ '/1/' + items[0]),
					gasoline = parseFloat(items[2]/100) || 0,
					rac = parseFloat(items[3]),
					tmpDate = new Date(date);
					
				if( tmpDate <= now )
					 tmp = date;
					 
				if ( !isNaN( date ) ) {
					gasolineSeries.data.push( [date, gasoline] );
					racSeries.data.push( [date, rac] );
				}
			});
			
			opts_prices_gasoline_crude.series.push(gasolineSeries);
			opts_prices_gasoline_crude.series.push(racSeries);
			
			chart = new Highcharts.Chart(opts_prices_gasoline_crude);
				
			//get y axis min/max values to draw the vertical separator
			var extremes = chart.yAxis[1].getExtremes();
			
			breakLine.data = [[tmp, extremes.min], [tmp, extremes.max]];
			
			chart.addSeries( breakLine );
			
			chart.renderer.image('../..//global/images/icons/icon_interactive.gif', 625, 23, 69, 17)
			.add();
			
			},'json');

	});
	</script>

<div id="price_gas"></div>